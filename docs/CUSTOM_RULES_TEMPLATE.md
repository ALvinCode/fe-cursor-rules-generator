# 自定义规则模板功能说明

## 功能概述

在生成基础规则的同时，系统会自动生成一个自定义规则模板文件（`custom-rules-template.mdc`），供用户填写项目特定的自定义规则。

## 核心特性

### 1. 自动生成
- 每次运行 `generate_cursor_rules` 时，会自动生成模板文件
- 文件位置：`.cursor/rules/custom-rules-template.mdc`
- 包含完整的元数据配置和编写指导

### 2. 完全可选
- 如果用户不填写，不影响其他规则的执行
- 可以安全删除，不会破坏规则系统
- Cursor 会自动忽略空模板或未填写的模板

### 3. 完整指导
模板文件包含：
- 使用说明（何时使用、如何填写）
- 编写示例（业务规则、性能优化、团队约定）
- 最佳实践指导
- 元数据配置说明
- 依赖关系设置指南
- 填写检查清单

## 文件结构

```
项目根目录/
└── .cursor/
    ├── instructions.md
    └── rules/
        ├── global-rules.mdc          # 自动生成
        ├── code-style.mdc            # 自动生成
        ├── architecture.mdc          # 自动生成
        ├── custom-tools.mdc          # 自动生成（如果存在）
        ├── ...                       # 其他自动生成的规则
        └── custom-rules-template.mdc # 自动生成的模板（可选填写）
```

## 使用流程

### 1. 生成规则
运行 `generate_cursor_rules` 后，模板文件会自动生成。

### 2. 查看模板
打开 `.cursor/rules/custom-rules-template.mdc`，查看完整的编写指导。

### 3. 填写规则（可选）
- 修改元数据（title、description、priority、depends）
- 删除模板说明部分
- 填写实际的规则内容
- 参考模板中的示例

### 4. 验证规则（可选）
使用 `validate_rules` 工具验证规则格式是否正确。

## 模板内容示例

模板文件包含以下主要部分：

1. **重要提示** - 说明这是可选文件
2. **使用说明** - 何时使用、如何填写
3. **编写模板** - 三个实际示例（业务规则、性能优化、团队约定）
4. **最佳实践** - 规则编写的 5 个最佳实践
5. **元数据配置** - 详细的配置说明
6. **检查清单** - 填写前的确认项

## 优先级设置

模板默认优先级为 60，建议范围：
- **60-69**: 补充性规则（如团队约定）
- **70-79**: 重要实践（如性能优化）
- **80-85**: 核心规范（如业务规则）

## 依赖关系

模板默认依赖 `global-rules.mdc`，可以根据需要添加其他依赖：
- `code-style.mdc` - 如果涉及代码风格
- `architecture.mdc` - 如果涉及文件组织
- `custom-tools.mdc` - 如果使用项目自定义工具

## 集成说明

### 在 global-rules.mdc 中
模板文件会被自动添加到开发规范文件列表中，标记为可选。

### 在 instructions.md 中
模板文件会被添加到规则文件索引中，并提供使用说明。

### 在规则摘要中
模板文件会被包含在生成摘要中，标记为可选文件。

## 技术实现

### 代码位置
- 生成方法：`src/modules/rules-generator.ts` 中的 `generateCustomRuleTemplate()`
- 调用位置：`generate()` 方法的最后，在返回规则列表之前

### 文件特性
- **scope**: `specialized` - 专题规则
- **priority**: `60` - 较低优先级
- **type**: `guideline` - 指导性规则
- **depends**: `["global-rules"]` - 依赖全局规则

## 注意事项

1. **文件命名**: 模板文件名固定为 `custom-rules-template.mdc`，不要修改
2. **元数据**: 填写时必须保留元数据部分（`---` 之间的内容）
3. **依赖关系**: 确保依赖的规则文件存在
4. **内容格式**: 遵循 Markdown 格式，使用代码块提供示例
5. **文件引用**: 使用 `@文件名` 引用项目文件，使用 `@规则名.mdc` 引用其他规则

## 最佳实践

1. **先阅读模板**: 在填写前，完整阅读模板中的指导
2. **参考示例**: 使用模板中的示例作为起点
3. **保持简洁**: 规则内容应该清晰、可执行
4. **提供示例**: 始终提供 ✅ 正确和 ❌ 错误的对比示例
5. **引用文件**: 使用 `@文件名` 引用项目中的实际文件
6. **测试验证**: 填写后使用 `validate_rules` 验证格式

## 常见问题

### Q: 如果我不需要自定义规则，可以删除模板文件吗？
A: 可以。模板文件是完全可选的，删除后不影响其他规则的执行。

### Q: 模板文件会被重新生成覆盖吗？
A: 是的。每次运行 `generate_cursor_rules` 时，如果模板文件不存在或内容仍然是模板状态，会被重新生成。如果已经填写了内容，建议在生成前备份。

### Q: 如何防止模板文件被覆盖？
A: 填写内容后，模板文件就变成了自定义规则文件。系统不会覆盖已填写的内容（除非文件被删除）。

### Q: 可以创建多个自定义规则文件吗？
A: 可以。除了模板文件，您还可以手动创建其他自定义规则文件，只需遵循相同的格式即可。

### Q: 自定义规则的优先级如何设置？
A: 建议根据规则的重要性设置：
- 补充性规则：60-69
- 重要实践：70-79
- 核心规范：80-85

## 更新日志

- **v1.8.0**: 添加自定义规则模板自动生成功能
  - 自动生成包含完整指导的模板文件
  - 集成到 global-rules 和 instructions 中
  - 支持可选使用，不影响其他规则

