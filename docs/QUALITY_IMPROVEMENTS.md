# ç”Ÿæˆè´¨é‡ä¿éšœæœºåˆ¶å®ç°è¯´æ˜

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜æ–°å¢çš„è´¨é‡ä¿éšœæœºåˆ¶ï¼ŒåŒ…æ‹¬å®ç°æ€è·¯ã€ä½¿ç”¨æ–¹æ³•å’Œæ”¹è¿›æ–¹å‘ã€‚

## ğŸ“‹ ç›®å½•

1. [ç”Ÿæˆè´¨é‡è¯„ä¼°](#ç”Ÿæˆè´¨é‡è¯„ä¼°)
2. [è§„åˆ™å†…å®¹éªŒè¯](#è§„åˆ™å†…å®¹éªŒè¯)
3. [ç²¾ç»†ç½®ä¿¡åº¦è¯„ä¼°](#ç²¾ç»†ç½®ä¿¡åº¦è¯„ä¼°)
4. [è§„åˆ™æ•ˆæœè¯„ä¼°](#è§„åˆ™æ•ˆæœè¯„ä¼°)

---

## 1. ç”Ÿæˆè´¨é‡è¯„ä¼°

### å®ç°æ€è·¯

`QualityAssessor` æ¨¡å—ä»å¤šä¸ªç»´åº¦è¯„ä¼°ç”Ÿæˆçš„è§„åˆ™è´¨é‡ï¼š

- **å®Œæ•´æ€§** (25%): æ£€æŸ¥æ˜¯å¦åŒ…å«å¿…è¦çš„ç« èŠ‚å’Œä¿¡æ¯
- **å‡†ç¡®æ€§** (30%): éªŒè¯è§„åˆ™å†…å®¹ä¸é¡¹ç›®å®é™…æƒ…å†µçš„åŒ¹é…åº¦
- **ç»“æ„** (15%): è¯„ä¼°è§„åˆ™çš„ç»„ç»‡ç»“æ„å’Œæ ¼å¼
- **æœ€ä½³å®è·µ** (20%): æ£€æŸ¥æ˜¯å¦éµå¾ªæœ€ä½³å®è·µ
- **æ¸…æ™°åº¦** (10%): è¯„ä¼°å†…å®¹çš„å¯è¯»æ€§å’Œç†è§£æ€§

### æ ¸å¿ƒé€»è¾‘

```typescript
// è¯„ä¼°å•ä¸ªè§„åˆ™çš„è´¨é‡
assessRuleQuality(rule, context) {
  // 1. æ£€æŸ¥å¿…éœ€ç« èŠ‚ï¼ˆæ ¹æ®è§„åˆ™ç±»å‹ï¼‰
  // 2. éªŒè¯æŠ€æœ¯æ ˆä¿¡æ¯å‡†ç¡®æ€§
  // 3. æ£€æŸ¥ä»£ç ç¤ºä¾‹æ•°é‡å’Œè´¨é‡
  // 4. è¯„ä¼°ç»“æ„åˆç†æ€§
  // 5. æ£€æŸ¥æœ€ä½³å®è·µè¦†ç›–
  // 6. è¯„ä¼°æ¸…æ™°åº¦
  // 7. ç”Ÿæˆç»¼åˆè¯„åˆ†å’Œæ”¹è¿›å»ºè®®
}
```

### ä½¿ç”¨æ–¹æ³•

```typescript
import { QualityAssessor } from './modules/quality-assessor.js';

const assessor = new QualityAssessor();
const assessment = assessor.assessQuality(rules, context);

// è·å–è´¨é‡æŠ¥å‘Š
const report = assessor.generateQualityReport(assessment);
```

### æ”¹è¿›æ–¹å‘

1. **æ›´ç»†ç²’åº¦çš„æ£€æŸ¥**: å¢åŠ å¯¹ä»£ç ç¤ºä¾‹è¯­æ³•æ­£ç¡®æ€§çš„æ£€æŸ¥
2. **ä¸Šä¸‹æ–‡æ„ŸçŸ¥**: æ ¹æ®é¡¹ç›®ç±»å‹è°ƒæ•´è¯„ä¼°æ ‡å‡†
3. **æœºå™¨å­¦ä¹ ä¼˜åŒ–**: åŸºäºå†å²æ•°æ®è®­ç»ƒè´¨é‡é¢„æµ‹æ¨¡å‹

---

## 2. è§„åˆ™å†…å®¹éªŒè¯

### å®ç°æ€è·¯

`RuleContentValidator` éªŒè¯è§„åˆ™å†…å®¹çš„æ­£ç¡®æ€§å’Œä¸€è‡´æ€§ï¼š

- **æŠ€æœ¯æ ˆä¸€è‡´æ€§**: æ£€æŸ¥è§„åˆ™ä¸­æåˆ°çš„æŠ€æœ¯æ˜¯å¦ä¸é¡¹ç›®åŒ¹é…
- **ä¾èµ–ä¸€è‡´æ€§**: éªŒè¯è§„åˆ™ä¸­å¼•ç”¨çš„ä¾èµ–æ˜¯å¦çœŸå®å­˜åœ¨
- **ä»£ç ç‰¹å¾ä¸€è‡´æ€§**: ç¡®ä¿è§„åˆ™åæ˜ äº†é¡¹ç›®çš„å®é™…ä»£ç ç‰¹å¾
- **å†…å®¹çŸ›ç›¾æ£€æµ‹**: å‘ç°è§„åˆ™ä¸­ç›¸äº’çŸ›ç›¾çš„æè¿°
- **ä»£ç ç¤ºä¾‹éªŒè¯**: æ£€æŸ¥ç¤ºä¾‹ä»£ç çš„æ­£ç¡®æ€§

### æ ¸å¿ƒé€»è¾‘

```typescript
validateContent(rule, context) {
  // 1. æå–è§„åˆ™ä¸­æåˆ°çš„æŠ€æœ¯æ ˆ
  // 2. ä¸é¡¹ç›®å®é™…æŠ€æœ¯æ ˆå¯¹æ¯”
  // 3. æ£€æŸ¥ä¾èµ–å¼•ç”¨æ˜¯å¦æ­£ç¡®
  // 4. éªŒè¯ä»£ç ç‰¹å¾æè¿°
  // 5. æ£€æµ‹å†…å®¹çŸ›ç›¾
  // 6. éªŒè¯ä»£ç ç¤ºä¾‹
  // 7. ç”ŸæˆéªŒè¯æŠ¥å‘Š
}
```

### ä½¿ç”¨æ–¹æ³•

```typescript
import { RuleContentValidator } from './modules/rule-content-validator.js';

const validator = new RuleContentValidator();
const result = validator.validateContent(rule, context);

if (!result.isValid) {
  const report = validator.generateValidationReport(result);
  // å¤„ç†éªŒè¯é—®é¢˜
}
```

### æ”¹è¿›æ–¹å‘

1. **ä»£ç ç¤ºä¾‹æ‰§è¡ŒéªŒè¯**: å®é™…è¿è¡Œä»£ç ç¤ºä¾‹æ£€æŸ¥è¯­æ³•
2. **é“¾æ¥æœ‰æ•ˆæ€§æ£€æŸ¥**: éªŒè¯è§„åˆ™ä¸­çš„å¤–éƒ¨é“¾æ¥
3. **è¯­ä¹‰åˆ†æ**: ä½¿ç”¨ NLP æŠ€æœ¯æ£€æµ‹è¯­ä¹‰çŸ›ç›¾

---

## 3. ç²¾ç»†ç½®ä¿¡åº¦è¯„ä¼°

### å®ç°æ€è·¯

`ConfidenceScorer` æä¾› 0-100 çš„æ•°å€¼ç½®ä¿¡åº¦è¯„åˆ†ï¼Œæ›¿ä»£ç®€å•çš„ high/medium/low ä¸‰çº§åˆ†ç±»ï¼š

- **å¤šæºè¯„ä¼°**: ç»¼åˆä¾èµ–æ£€æµ‹ã€æ–‡ä»¶ç»“æ„ã€ä»£ç åˆ†æã€é…ç½®æ–‡ä»¶ç­‰å¤šä¸ªæ¥æº
- **æƒé‡åˆ†é…**: ä¸åŒæ¥æºæœ‰ä¸åŒçš„æƒé‡å’Œå¯é æ€§
- **å½±å“å› å­**: è€ƒè™‘å¤šæºä¸€è‡´æ€§ã€è¯æ®æ•°é‡ã€å¯é æ€§ç­‰å› ç´ 
- **è¯¦ç»†è¯´æ˜**: æä¾›ç½®ä¿¡åº¦æ¥æºå’Œå½±å“å› å­çš„è¯¦ç»†è¯´æ˜

### æ ¸å¿ƒé€»è¾‘

```typescript
assessTechStackConfidence(context) {
  // 1. è¯„ä¼°å„ä¸ªæ£€æµ‹æºçš„ç½®ä¿¡åº¦
  //    - ä¾èµ–æ£€æµ‹ (æƒé‡ 35%)
  //    - æ–‡ä»¶ç»“æ„ (æƒé‡ 25%)
  //    - ä»£ç åˆ†æ (æƒé‡ 25%)
  //    - é…ç½®æ–‡ä»¶ (æƒé‡ 15%)
  // 2. è®¡ç®—åŠ æƒå¹³å‡åˆ†æ•°
  // 3. è¯„ä¼°å½±å“å› å­ï¼ˆå¤šæºä¸€è‡´æ€§ã€è¯æ®æ•°é‡ç­‰ï¼‰
  // 4. è°ƒæ•´æœ€ç»ˆåˆ†æ•°
  // 5. ç”Ÿæˆè¯¦ç»†è¯´æ˜å’Œå»ºè®®
}
```

### ç½®ä¿¡åº¦ç­‰çº§æ˜ å°„

- **90-100**: very-high (éå¸¸é«˜)
- **70-89**: high (é«˜)
- **50-69**: medium (ä¸­ç­‰)
- **30-49**: low (ä½)
- **0-29**: very-low (éå¸¸ä½)

### ä½¿ç”¨æ–¹æ³•

```typescript
import { ConfidenceScorer } from './modules/confidence-scorer.js';

const scorer = new ConfidenceScorer();
const score = scorer.assessTechStackConfidence(context);

console.log(`ç½®ä¿¡åº¦: ${score.value}/100 (${score.level})`);
console.log(score.explanation);
```

### æ”¹è¿›æ–¹å‘

1. **åŠ¨æ€æƒé‡è°ƒæ•´**: æ ¹æ®å†å²æ•°æ®è‡ªåŠ¨è°ƒæ•´æƒé‡
2. **ç½®ä¿¡åº¦ä¼ æ’­**: è€ƒè™‘ä¸åŒæ£€æµ‹æºä¹‹é—´çš„ä¾èµ–å…³ç³»
3. **ä¸ç¡®å®šæ€§é‡åŒ–**: æä¾›ç½®ä¿¡åº¦åŒºé—´è€Œéå•ä¸€å€¼

---

## 4. è§„åˆ™æ•ˆæœè¯„ä¼°

### å®ç°æ€è·¯

`RuleEffectivenessTracker` è·Ÿè¸ªå’Œè¯„ä¼°è§„åˆ™å¯¹ä»£ç è´¨é‡çš„å½±å“ï¼š

- **ä»£ç è´¨é‡æŒ‡æ ‡**: ç±»å‹å®‰å…¨ã€é”™è¯¯å¤„ç†ã€æµ‹è¯•è¦†ç›–ç‡ã€ä»£ç ä¸€è‡´æ€§
- **è§„åˆ™é‡‡ç”¨åº¦**: è§„åˆ™æåŠç‡ã€ä»£ç ç¬¦åˆåº¦ã€ä½¿ç”¨é¢‘ç‡
- **ç”Ÿäº§åŠ›æŒ‡æ ‡**: ä»£ç ç”Ÿæˆé€Ÿåº¦ã€è¿­ä»£æ¬¡æ•°ã€ç”¨æˆ·æ»¡æ„åº¦
- **è¶‹åŠ¿åˆ†æ**: è·Ÿè¸ªæŒ‡æ ‡éšæ—¶é—´çš„å˜åŒ–è¶‹åŠ¿

### æ ¸å¿ƒé€»è¾‘

```typescript
assessEffectiveness(projectPath, ruleVersion) {
  // 1. è¯„ä¼°ä»£ç è´¨é‡
  //    - ç±»å‹å®‰å…¨ä½¿ç”¨ç‡
  //    - é”™è¯¯å¤„ç†è¦†ç›–ç‡
  //    - æµ‹è¯•è¦†ç›–ç‡
  //    - ä»£ç ä¸€è‡´æ€§
  // 2. è¯„ä¼°è§„åˆ™é‡‡ç”¨åº¦
  //    - è§„åˆ™æåŠç‡
  //    - ä»£ç ç¬¦åˆåº¦
  //    - ä½¿ç”¨é¢‘ç‡
  // 3. è¯„ä¼°ç”Ÿäº§åŠ›ï¼ˆç®€åŒ–ï¼‰
  // 4. è®¡ç®—ç»¼åˆè¯„åˆ†
  // 5. ç”Ÿæˆæ”¹è¿›å»ºè®®
}
```

### ä½¿ç”¨æ–¹æ³•

```typescript
import { RuleEffectivenessTracker } from './modules/rule-effectiveness-tracker.js';

const tracker = new RuleEffectivenessTracker();

// è¯„ä¼°æ•ˆæœ
const metrics = await tracker.assessEffectiveness(projectPath, "1.0.0");

// ä¿å­˜è·Ÿè¸ªæ•°æ®
await tracker.saveTracking(projectPath, "1.0.0", metrics);

// ç”ŸæˆæŠ¥å‘Š
const report = tracker.generateEffectivenessReport(tracking);
```

### æ”¹è¿›æ–¹å‘

1. **æ›´ç²¾ç¡®çš„æŒ‡æ ‡**: ä½¿ç”¨ä»£ç åˆ†æå·¥å…·è·å–æ›´å‡†ç¡®çš„æŒ‡æ ‡
2. **å¯¹æ¯”åˆ†æ**: ä¸æœªä½¿ç”¨è§„åˆ™çš„é¡¹ç›®å¯¹æ¯”
3. **é¢„æµ‹æ¨¡å‹**: åŸºäºå†å²æ•°æ®é¢„æµ‹è§„åˆ™æ•ˆæœ

---

## é›†æˆå»ºè®®

### åœ¨ä¸»æµç¨‹ä¸­é›†æˆ

```typescript
// åœ¨ generate_cursor_rules ä¸­
async handleGenerateRules(args) {
  // ... ç°æœ‰ç”Ÿæˆé€»è¾‘ ...

  // 1. è´¨é‡è¯„ä¼°
  const qualityAssessor = new QualityAssessor();
  const qualityAssessment = qualityAssessor.assessQuality(rules, context);
  
  // 2. å†…å®¹éªŒè¯
  const contentValidator = new RuleContentValidator();
  for (const rule of rules) {
    const validation = contentValidator.validateContent(rule, context);
    if (!validation.isValid) {
      // è®°å½•éªŒè¯é—®é¢˜
    }
  }

  // 3. ç½®ä¿¡åº¦è¯„ä¼°
  const confidenceScorer = new ConfidenceScorer();
  const confidence = confidenceScorer.assessTechStackConfidence(context);

  // 4. æ•ˆæœè·Ÿè¸ªï¼ˆå¼‚æ­¥ï¼‰
  const effectivenessTracker = new RuleEffectivenessTracker();
  effectivenessTracker.assessEffectiveness(projectPath, version)
    .then(metrics => {
      effectivenessTracker.saveTracking(projectPath, version, metrics);
    });

  // è¿”å›ç»“æœæ—¶åŒ…å«è´¨é‡ä¿¡æ¯
  return {
    ...existingResult,
    quality: qualityAssessment,
    confidence: confidence,
    validation: validationResults
  };
}
```

---

## æ€»ç»“

è¿™äº›è´¨é‡ä¿éšœæœºåˆ¶å½¢æˆäº†ä¸€ä¸ªå®Œæ•´çš„è´¨é‡ä¿éšœä½“ç³»ï¼š

1. **äº‹å‰**: ç½®ä¿¡åº¦è¯„ä¼° â†’ ç¡®ä¿æ£€æµ‹å‡†ç¡®æ€§
2. **äº‹ä¸­**: è´¨é‡è¯„ä¼° + å†…å®¹éªŒè¯ â†’ ç¡®ä¿ç”Ÿæˆè´¨é‡
3. **äº‹å**: æ•ˆæœè¯„ä¼° â†’ è·Ÿè¸ªæ”¹è¿›

é€šè¿‡è¿™äº›æœºåˆ¶ï¼Œå¯ä»¥æŒç»­æå‡è§„åˆ™ç”Ÿæˆçš„è´¨é‡å’Œå¯é æ€§ã€‚

