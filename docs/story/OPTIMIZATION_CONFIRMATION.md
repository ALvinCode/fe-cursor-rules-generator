# 优化需求确认

## ✅ 已确认的问题

### 问题 1：编码习惯占比阈值 ✅
- **< 30%**：不考虑（不是编码习惯）
- **30% - 70%**：需要用户确认（模糊习惯）
- **> 70%**：默认采用（明确的编码习惯）
- **针对不同类型设置不同阈值**：
  - 代码风格（变量声明、函数风格等）：**> 80%**
  - 错误处理方式：**> 60%**
  - 文件组织方式：**> 85%**
  - 组件模式：**> 75%**

### 问题 2：建议展示方式 ✅
- 在生成规则后的输出中单独列出所有建议
- 按类型分类（代码风格、架构、性能、安全、错误处理等）
- 用户手动决定是否采纳，采纳后可以重新生成规则

### 问题 3：最佳实践提取范围 ✅
需要匹配：
1. **项目技术栈中直接相关的最佳实践**
2. **匹配框架规则文件中，项目实际有所涉及和使用的最佳实践**
3. **项目有涉及和使用，但匹配框架规则中并没有提到的技术栈的最佳实践**，联网查询对应技术栈的最佳实践并提取和使用
4. **禁止生成项目没有涉及和使用的规则**

### 问题 4：MD 文件处理 ✅
- 除了 `.cursor/instructions.md` 以及 `.cursor/rules` 中的规则 md 文件，不保留其他的 MD 文件
- **需要在规则中明确禁止生成任何 MD 文件（除了 instructions.md）**

### 问题 5：建议的分类方式 ✅
**分类指的是"建议"的分类方式**，即如何组织展示给用户的建议列表：

- **按类型分类**：代码风格、架构、性能、安全、错误处理等
- **按优先级分类**：高、中、低
- **按影响范围分类**：全局、模块、文件

**采用方式**：按类型 + 优先级分类，便于用户选择采纳哪些建议。

---

## 📋 实施计划

### 阶段 1：核心功能实现
1. ✅ 创建最佳实践提取器（从 awesome-cursorrules 提取）
2. ✅ 创建最佳实践对比器（对比项目实际情况）
3. ✅ 实现建议分离机制（从规则中移除，单独收集）
4. ✅ 实现占比判断和用户确认机制
5. ✅ 添加禁止生成 MD 文件的规则

### 阶段 2：最佳实践补充机制
1. ✅ 从匹配的框架规则文件中提取最佳实践
2. ✅ 对比项目实际情况，找出项目已使用但未在规则中声明的实践
3. ✅ 对于项目使用但框架规则中没有的技术栈，联网查询最佳实践
4. ✅ 将这些实践补充到生成的规则中

### 阶段 3：测试和优化
1. ✅ 测试各种场景
2. ✅ 优化阈值和判断逻辑
3. ✅ 更新文档

---

**开始实施...**

